<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>States · MPSKit.jl</title><meta name="title" content="States · MPSKit.jl"/><meta property="og:title" content="States · MPSKit.jl"/><meta property="twitter:title" content="States · MPSKit.jl"/><meta name="description" content="Documentation for MPSKit.jl."/><meta property="og:description" content="Documentation for MPSKit.jl."/><meta property="twitter:description" content="Documentation for MPSKit.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="MPSKit.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MPSKit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../intro/">Prerequisites</a></li><li class="is-active"><a class="tocitem" href>States</a><ul class="internal"><li><a class="tocitem" href="#FiniteMPS"><span>FiniteMPS</span></a></li><li><a class="tocitem" href="#InfiniteMPS"><span>InfiniteMPS</span></a></li><li><a class="tocitem" href="#WindowMPS"><span>WindowMPS</span></a></li><li><a class="tocitem" href="#Multiline"><span>Multiline</span></a></li></ul></li><li><a class="tocitem" href="../operators/">Operators</a></li><li><a class="tocitem" href="../algorithms/">Algorithms</a></li><li><a class="tocitem" href="../environments/">Environments</a></li><li><a class="tocitem" href="../parallelism/">Parallelism in julia</a></li></ul></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../lib/lib/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>States</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>States</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/maartenvd/MPSKit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/maartenvd/MPSKit.jl/blob/master/docs/src/man/states.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="um_states"><a class="docs-heading-anchor" href="#um_states">States</a><a id="um_states-1"></a><a class="docs-heading-anchor-permalink" href="#um_states" title="Permalink"></a></h1><h2 id="FiniteMPS"><a class="docs-heading-anchor" href="#FiniteMPS">FiniteMPS</a><a id="FiniteMPS-1"></a><a class="docs-heading-anchor-permalink" href="#FiniteMPS" title="Permalink"></a></h2><p>A FiniteMPS is - at its core - a chain of mps tensors.</p><p><img src="../finite_mps_definition.png" alt/></p><h3 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h3><p>A <a href="../../lib/lib/#MPSKit.FiniteMPS"><code>FiniteMPS</code></a> can be created by passing in a vector of tensormaps:</p><pre><code class="language-julia hljs">data = fill(TensorMap(rand,ComplexF64,ℂ^1*ℂ^2,ℂ^1),10);
FiniteMPS(data);</code></pre><p>Or alternatively by</p><pre><code class="language-julia hljs">len = 10;
max_bond_dimension = ℂ^10;
physical_space = ℂ^2;
FiniteMPS(rand,ComplexF64,len,physical_space,max_bond_dimension);</code></pre><p>You can take dot products, renormalize!, expectation values,....</p><h3 id="Gauging"><a class="docs-heading-anchor" href="#Gauging">Gauging</a><a id="Gauging-1"></a><a class="docs-heading-anchor-permalink" href="#Gauging" title="Permalink"></a></h3><p>There is residual gauge freedom in such a finite mps :</p><p><img src="../mps_gauge_freedom.png" alt/></p><p>which is often exploited in mps algorithms. The gauging logic is handled behind the scenes, if you call</p><pre><code class="language-julia hljs">state.AL[3]</code></pre><p>then the state will be gauged such that the third tensor is a left isometry (similarly for state.AR).</p><pre><code class="language-julia hljs">state.AC[3]</code></pre><p>gauges the state in such a way that all tensors to the left are left isometries, and to the right will be right isometries.As a result you should have</p><pre><code class="language-julia hljs">norm(state) == norm(state.AC[3])</code></pre><p>lastly there is also the CR field, with the following property:</p><pre><code class="language-julia hljs">@tensor a[-1 -2;-3] := state.AL[3][-1 -2;1]*state.CR[3][1;-3]
@tensor b[-1 -2;-3] := state.CR[2][-1;1]*state.AR[3][1 -2;-3]
a ≈ state.AC[3];
b ≈ state.AC[3];</code></pre><h3 id="Implementation-details"><a class="docs-heading-anchor" href="#Implementation-details">Implementation details</a><a id="Implementation-details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-details" title="Permalink"></a></h3><p>Behind the scenes, a finite mps has 4 fields</p><pre><code class="language-julia hljs">ALs::Vector{Union{Missing,A}}
ARs::Vector{Union{Missing,A}}
ACs::Vector{Union{Missing,A}}
CLs::Vector{Union{Missing,B}}</code></pre><p>calling state.AC returns an &quot;orthoview&quot; instance, which is a very simple dummy object. When you call get/setindex on an orthoview, it will move the gauge for the underlying state, and return the result. The idea behind this construction is that one never has to worry about how the state is gauged, as this gets handled automagically.</p><p>The following bit of code shows the logic in action:</p><pre><code class="language-julia hljs">state = FiniteMPS(10,ℂ^2,ℂ^10); # a random initial state
@show ismissing.(state.ALs) # all AL fields are already calculated
@show ismissing.(state.ARs) # all AR fields are missing

#if we now query state.AC[2], it should calculate and store all AR fields left of position 2
state.AC[2];
@show ismissing.(state.ARs)</code></pre><h2 id="InfiniteMPS"><a class="docs-heading-anchor" href="#InfiniteMPS">InfiniteMPS</a><a id="InfiniteMPS-1"></a><a class="docs-heading-anchor-permalink" href="#InfiniteMPS" title="Permalink"></a></h2><p>An infinite mps can be thought of as a finite mps, where the set of tensors is repeated periodically.</p><p>It can be created by passing in a vector of tensormaps:</p><pre><code class="language-julia hljs">data = fill(TensorMap(rand,ComplexF64,ℂ^10*ℂ^2,ℂ^10),2);
InfiniteMPS(data);</code></pre><p>The above code would create an infinite mps with an A-B structure (a 2 site unit cell).</p><p>much like a finite mps, we can again query the fields state.AL, state.AR, state.AC and state.CR. The implementation is much easier, as they are now just plain fields in the struct</p><pre><code class="language-julia hljs">AL::PeriodicArray{A,1}
AR::PeriodicArray{A,1}
CR::PeriodicArray{B,1}
AC::PeriodicArray{A,1}</code></pre><p>The periodic array is an array-like type where all indices are repeated periodically.</p><h2 id="WindowMPS"><a class="docs-heading-anchor" href="#WindowMPS">WindowMPS</a><a id="WindowMPS-1"></a><a class="docs-heading-anchor-permalink" href="#WindowMPS" title="Permalink"></a></h2><p>WindowMPS is a bit of a mix between an infinite mps and a finite mps. It represents a window of mutable tensors embedded in an infinite mps.</p><p>It can be created using:</p><pre><code class="language-julia hljs">mpco = WindowMPS(left_infinite_mps,window_of_tensors,right_infinite_mps)</code></pre><p>Algorithms will then act on this window of tensors, while leaving the left and right infinite mps&#39;s invariant.</p><p>Behind the scenes it uses the same orthoview logic as finitemps.</p><h2 id="Multiline"><a class="docs-heading-anchor" href="#Multiline">Multiline</a><a id="Multiline-1"></a><a class="docs-heading-anchor-permalink" href="#Multiline" title="Permalink"></a></h2><p>Statistical physics partition functions can be represented by an infinite tensor network which then needs to be contracted. This is done by finding approximate fixpoint infinite matrix product states. However, there is no good reason why a single mps should suffice and indeed we find in practice that this can require a nontrivial unit cell in both dimensions.</p><p>In other words, the fixpoints can be well described by a set of matrix product states.</p><p>Such a set can be created by</p><pre><code class="language-julia hljs">data = fill(TensorMap(rand,ComplexF64,ℂ^10*ℂ^2,ℂ^10),2,2);
MPSMultiline(data);</code></pre><p>MPSMultiline is also used extensively in as of yet unreleased peps code.</p><p>You can access properties by calling</p><pre><code class="language-julia hljs">state.AL[row,collumn]
state.AC[row,collumn]
state.AR[row,collumn]
state.CR[row,collumn]</code></pre><p>Behind the scenes, we have a type called Multiline, defined as:</p><pre><code class="language-julia hljs">struct Multiline{T}
    data::PeriodicArray{T,1}
end</code></pre><p>MPSMultiline/MPOMultiline are then defined as ```julia const MPSMultiline = Multiline{&lt;:InfiniteMPS} const MPOMultiline = Multiline{&lt;:DenseMPO}</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../intro/">« Prerequisites</a><a class="docs-footer-nextpage" href="../operators/">Operators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 4 December 2023 15:54">Monday 4 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
